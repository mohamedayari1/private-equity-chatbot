module.exports=[14747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},24361,(e,t,r)=>{t.exports=e.x("util",()=>require("util"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},66680,(e,t,r)=>{t.exports=e.x("node:crypto",()=>require("node:crypto"))},54799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},12057,(e,t,r)=>{t.exports=e.x("node:util",()=>require("node:util"))},75931,e=>{"use strict";let t={database:"log",chat:"response",auth:"response",stream:"response",api:"response",history:"response",vote:"response",document:"response",suggestions:"response"};class r extends Error{type;surface;statusCode;constructor(e,t){super();const[r,n]=e.split(":");this.type=r,this.cause=t,this.surface=n,this.message=function(e){if(e.includes("database"))return"An error occurred while executing a database query.";switch(e){case"bad_request:api":return"The request couldn't be processed. Please check your input and try again.";case"unauthorized:auth":return"You need to sign in before continuing.";case"forbidden:auth":return"Your account does not have access to this feature.";case"rate_limit:chat":return"You have exceeded your maximum number of messages for the day. Please try again later.";case"not_found:chat":return"The requested chat was not found. Please check the chat ID and try again.";case"forbidden:chat":return"This chat belongs to another user. Please check the chat ID and try again.";case"unauthorized:chat":return"You need to sign in to view this chat. Please sign in and try again.";case"offline:chat":return"We're having trouble sending your message. Please check your internet connection and try again.";case"not_found:document":return"The requested document was not found. Please check the document ID and try again.";case"forbidden:document":return"This document belongs to another user. Please check the document ID and try again.";case"unauthorized:document":return"You need to sign in to view this document. Please sign in and try again.";case"bad_request:document":return"The request to create or update the document was invalid. Please check your input and try again.";default:return"Something went wrong. Please try again later."}}(e),this.statusCode=function(e){switch(e){case"bad_request":return 400;case"unauthorized":return 401;case"forbidden":return 403;case"not_found":return 404;case"rate_limit":return 429;case"offline":return 503;default:return 500}}(this.type)}toResponse(){let e=`${this.type}:${this.surface}`,r=t[this.surface],{message:n,cause:o,statusCode:a}=this;return"log"===r?(console.error({code:e,message:n,cause:o}),Response.json({code:"",message:"Something went wrong. Please try again later."},{status:a})):Response.json({code:e,message:n,cause:o},{status:a})}}e.s(["ChatSDKError",()=>r])},59639,(e,t,r)=>{t.exports=e.x("node:process",()=>require("node:process"))},92509,(e,t,r)=>{t.exports=e.x("url",()=>require("url"))},4446,(e,t,r)=>{t.exports=e.x("net",()=>require("net"))},21517,(e,t,r)=>{t.exports=e.x("http",()=>require("http"))},88947,(e,t,r)=>{t.exports=e.x("stream",()=>require("stream"))},6461,(e,t,r)=>{t.exports=e.x("zlib",()=>require("zlib"))},24836,(e,t,r)=>{t.exports=e.x("https",()=>require("https"))},87769,(e,t,r)=>{t.exports=e.x("node:events",()=>require("node:events"))},55004,(e,t,r)=>{t.exports=e.x("tls",()=>require("tls"))},49719,(e,t,r)=>{t.exports=e.x("assert",()=>require("assert"))},45706,(e,t,r)=>{t.exports=e.x("querystring",()=>require("querystring"))},874,(e,t,r)=>{t.exports=e.x("buffer",()=>require("buffer"))},27699,(e,t,r)=>{t.exports=e.x("events",()=>require("events"))},81111,(e,t,r)=>{t.exports=e.x("node:stream",()=>require("node:stream"))},60438,(e,t,r)=>{t.exports=e.x("perf_hooks",()=>require("perf_hooks"))},22632,e=>{"use strict";e.s([],54033),e.i(54033);var t=e.i(85676),r=e.i(80264);e.s(["defaultErrorMap",()=>r.default,"getErrorMap",()=>t.getErrorMap,"setErrorMap",()=>t.setErrorMap],76733),e.i(76733);var n=e.i(84488);e.s([],91316),e.i(91316);var o=e.i(42944),a=e.i(92208),s=e.i(15235);e.s(["BRAND",()=>a.BRAND,"DIRTY",()=>n.DIRTY,"EMPTY_PATH",()=>n.EMPTY_PATH,"INVALID",()=>n.INVALID,"NEVER",()=>a.NEVER,"OK",()=>n.OK,"ParseStatus",()=>n.ParseStatus,"Schema",()=>a.Schema,"ZodAny",()=>a.ZodAny,"ZodArray",()=>a.ZodArray,"ZodBigInt",()=>a.ZodBigInt,"ZodBoolean",()=>a.ZodBoolean,"ZodBranded",()=>a.ZodBranded,"ZodCatch",()=>a.ZodCatch,"ZodDate",()=>a.ZodDate,"ZodDefault",()=>a.ZodDefault,"ZodDiscriminatedUnion",()=>a.ZodDiscriminatedUnion,"ZodEffects",()=>a.ZodEffects,"ZodEnum",()=>a.ZodEnum,"ZodError",()=>s.ZodError,"ZodFirstPartyTypeKind",()=>a.ZodFirstPartyTypeKind,"ZodFunction",()=>a.ZodFunction,"ZodIntersection",()=>a.ZodIntersection,"ZodIssueCode",()=>s.ZodIssueCode,"ZodLazy",()=>a.ZodLazy,"ZodLiteral",()=>a.ZodLiteral,"ZodMap",()=>a.ZodMap,"ZodNaN",()=>a.ZodNaN,"ZodNativeEnum",()=>a.ZodNativeEnum,"ZodNever",()=>a.ZodNever,"ZodNull",()=>a.ZodNull,"ZodNullable",()=>a.ZodNullable,"ZodNumber",()=>a.ZodNumber,"ZodObject",()=>a.ZodObject,"ZodOptional",()=>a.ZodOptional,"ZodParsedType",()=>o.ZodParsedType,"ZodPipeline",()=>a.ZodPipeline,"ZodPromise",()=>a.ZodPromise,"ZodReadonly",()=>a.ZodReadonly,"ZodRecord",()=>a.ZodRecord,"ZodSchema",()=>a.ZodSchema,"ZodSet",()=>a.ZodSet,"ZodString",()=>a.ZodString,"ZodSymbol",()=>a.ZodSymbol,"ZodTransformer",()=>a.ZodTransformer,"ZodTuple",()=>a.ZodTuple,"ZodType",()=>a.ZodType,"ZodUndefined",()=>a.ZodUndefined,"ZodUnion",()=>a.ZodUnion,"ZodUnknown",()=>a.ZodUnknown,"ZodVoid",()=>a.ZodVoid,"addIssueToContext",()=>n.addIssueToContext,"any",()=>a.any,"array",()=>a.array,"bigint",()=>a.bigint,"boolean",()=>a.boolean,"coerce",()=>a.coerce,"custom",()=>a.custom,"date",()=>a.date,"datetimeRegex",()=>a.datetimeRegex,"defaultErrorMap",()=>r.default,"discriminatedUnion",()=>a.discriminatedUnion,"effect",()=>a.effect,"enum",()=>a.enum,"function",()=>a.function,"getErrorMap",()=>t.getErrorMap,"getParsedType",()=>o.getParsedType,"instanceof",()=>a.instanceof,"intersection",()=>a.intersection,"isAborted",()=>n.isAborted,"isAsync",()=>n.isAsync,"isDirty",()=>n.isDirty,"isValid",()=>n.isValid,"late",()=>a.late,"lazy",()=>a.lazy,"literal",()=>a.literal,"makeIssue",()=>n.makeIssue,"map",()=>a.map,"nan",()=>a.nan,"nativeEnum",()=>a.nativeEnum,"never",()=>a.never,"null",()=>a.null,"nullable",()=>a.nullable,"number",()=>a.number,"object",()=>a.object,"objectUtil",()=>o.objectUtil,"oboolean",()=>a.oboolean,"onumber",()=>a.onumber,"optional",()=>a.optional,"ostring",()=>a.ostring,"pipeline",()=>a.pipeline,"preprocess",()=>a.preprocess,"promise",()=>a.promise,"quotelessJson",()=>s.quotelessJson,"record",()=>a.record,"set",()=>a.set,"setErrorMap",()=>t.setErrorMap,"strictObject",()=>a.strictObject,"string",()=>a.string,"symbol",()=>a.symbol,"transformer",()=>a.transformer,"tuple",()=>a.tuple,"undefined",()=>a.undefined,"union",()=>a.union,"unknown",()=>a.unknown,"util",()=>o.util,"void",()=>a.void],35907);var i=e.i(35907);e.s(["z",0,i],22632)},45655,e=>{"use strict";let t,r;var n=e.i(47909),o=e.i(74017),a=e.i(96250),s=e.i(59756),i=e.i(61916),d=e.i(74677),u=e.i(69741),l=e.i(16795),c=e.i(87718),p=e.i(95169),h=e.i(47587),m=e.i(66012),g=e.i(70101),f=e.i(74838),x=e.i(10372),y=e.i(93695);e.i(52474);var b=e.i(220),v=e.i(41752),R=e.i(75931),Z=e.i(66680);function w(){return function(e=21){var n;n=e|=0,!t||t.length<n?(t=Buffer.allocUnsafe(128*n),Z.webcrypto.getRandomValues(t),r=0):r+n>t.length&&(Z.webcrypto.getRandomValues(t),r=0),r+=n;let o="";for(let n=r-e;n<r;n++)o+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&t[n]];return o}()}var E=e.i(44855),q=e.i(60438),T=e.i(22632);let C=T.z.object({id:T.z.string(),message:T.z.object({role:T.z.string(),parts:T.z.array(T.z.object({type:T.z.string(),text:T.z.string()})),id:T.z.string()}),selectedChatModel:T.z.string(),selectedVisibilityType:T.z.string(),numResults:T.z.number().optional().default(5)});async function P(e){let t,r=q.performance.now();try{let r=await e.json();t=C.parse(r)}catch(e){return new R.ChatSDKError("bad_request:api").toResponse()}try{let e,n,{message:o,numResults:a,selectedChatModel:s}=t,i=o.parts.filter(e=>"text"===e.type).map(e=>e.text).join(" ");if(!i)return new R.ChatSDKError("bad_request:api","No text content found").toResponse();try{await E.vectorSearchService.connect();let t=await E.vectorSearchService.search(i,"number"==typeof a?a:5);e={success:!0,results:t,query:i,totalResults:t.length}}catch(t){e={success:!1,results:[],query:i,totalResults:0,error:t instanceof Error?t.message:"Vector search failed"}}let d=e.success?e.results.map(e=>e.text):[],u=(n=d.length>0?d.map((e,t)=>`Context ${t+1}:
${e}`).join("\n\n"):"No relevant context found.",`You are an expert Vedic astrologer and spiritual guide with deep knowledge of ancient Indian wisdom, astrology, and philosophy. You have studied the Vedas, Upanishads, and classical astrological texts extensively. Use the following context from authentic Vedic sources to answer the user's question with authority and wisdom.

Context:
${n}

User Question: ${i}

Please provide a comprehensive and authoritative answer based on the Vedic context provided. If the context doesn't contain enough information to answer the question accurately, acknowledge this and provide insights based on your deep knowledge of Vedic astrology and philosophy. Always maintain the spiritual and philosophical depth that characterizes authentic Vedic wisdom.`),l=new TextEncoder,c=new ReadableStream({async start(t){try{let r="";for await(let e of(0,v.sendGeminiStreamRequest)({text:u,temperature:.7,maxTokens:2048})){r+=e;let n=`data: ${JSON.stringify({id:w(),role:"assistant",parts:[{type:"text",text:r}]})}

`;t.enqueue(l.encode(n))}let n=`data: ${JSON.stringify({id:w(),role:"assistant",parts:[{type:"text",text:r}],metadata:{searchPerformed:e.success,contextChunksFound:d.length,totalSearchResults:e.totalResults,searchQuery:i,searchError:e.error}})}

`;t.enqueue(l.encode(n)),t.enqueue(l.encode("data: [DONE]\n\n")),t.close()}catch(r){console.error("Streaming error:",r);let e=`data: ${JSON.stringify({id:w(),role:"assistant",parts:[{type:"text",text:"Sorry, I encountered an error. Please try again."}]})}

`;t.enqueue(l.encode(e)),t.enqueue(l.encode("data: [DONE]\n\n")),t.close()}}}),p=q.performance.now();return console.log(`✅ [Total] RAG streaming pipeline completed in ${(p-r).toFixed(2)}ms`),new Response(c,{headers:{"Content-Type":"text/plain; charset=utf-8","Cache-Control":"no-cache",Connection:"keep-alive"}})}catch(t){let e=q.performance.now();return console.log(`❌ [Total] RAG route error after ${(e-r).toFixed(2)}ms:`,t),new R.ChatSDKError("bad_request:api","An error occurred while processing the RAG request").toResponse()}}e.s(["POST",()=>P,"maxDuration",0,60],94662);var N=e.i(94662);let S=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/(chat)/api/gemini/route",pathname:"/api/gemini",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/(chat)/api/gemini/route.ts",nextConfigOutput:"",userland:N}),{workAsyncStorage:A,workUnitAsyncStorage:k,serverHooks:D}=S;function I(){return(0,a.patchFetch)({workAsyncStorage:A,workUnitAsyncStorage:k})}async function _(e,t,r){S.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let n="/(chat)/api/gemini/route";n=n.replace(/\/index$/,"")||"/";let a=await S.prepare(e,t,{srcPage:n,multiZoneDraftMode:!1});if(!a)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:v,params:R,nextConfig:Z,parsedUrl:w,isDraftMode:E,prerenderManifest:q,routerServerContext:T,isOnDemandRevalidate:C,revalidateOnlyGenerated:P,resolvedPathname:N,clientReferenceManifest:A,serverActionsManifest:k}=a,D=(0,u.normalizeAppPath)(n),I=!!(q.dynamicRoutes[D]||q.routes[N]),_=async()=>((null==T?void 0:T.render404)?await T.render404(e,t,w,!1):t.end("This page could not be found"),null);if(I&&!E){let e=!!q.routes[N],t=q.dynamicRoutes[D];if(t&&!1===t.fallback&&!e){if(Z.experimental.adapterPath)return await _();throw new y.NoFallbackError}}let O=null;!I||S.isDev||E||(O="/index"===(O=N)?"/":O);let U=!0===S.isDev||!I,j=I&&!U;k&&A&&(0,d.setManifestsSingleton)({page:n,clientReferenceManifest:A,serverActionsManifest:k});let M=e.method||"GET",z=(0,i.getTracer)(),V=z.getActiveScopeSpan(),H={params:R,prerenderManifest:q,renderOpts:{experimental:{authInterrupts:!!Z.experimental.authInterrupts},cacheComponents:!!Z.cacheComponents,supportsDynamicResponse:U,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:Z.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n,o)=>S.onRequestError(e,t,n,o,T)},sharedContext:{buildId:v}},$=new l.NodeNextRequest(e),K=new l.NodeNextResponse(t),F=c.NextRequestAdapter.fromNodeNextRequest($,(0,c.signalFromNodeResponse)(t));try{let a=async e=>S.handle(F,H).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=z.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let o=r.get("next.route");if(o){let t=`${M} ${o}`;e.setAttributes({"next.route":o,"http.route":o,"next.span_name":t}),e.updateName(t)}else e.updateName(`${M} ${n}`)}),d=!!(0,s.getRequestMeta)(e,"minimalMode"),u=async s=>{var i,u;let l=async({previousCacheEntry:o})=>{try{if(!d&&C&&P&&!o)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await a(s);e.fetchMetrics=H.renderOpts.fetchMetrics;let i=H.renderOpts.pendingWaitUntil;i&&r.waitUntil&&(r.waitUntil(i),i=void 0);let u=H.renderOpts.collectedTags;if(!I)return await (0,m.sendResponse)($,K,n,H.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,g.toNodeOutgoingHttpHeaders)(n.headers);u&&(t[x.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==H.renderOpts.collectedRevalidate&&!(H.renderOpts.collectedRevalidate>=x.INFINITE_CACHE)&&H.renderOpts.collectedRevalidate,o=void 0===H.renderOpts.collectedExpire||H.renderOpts.collectedExpire>=x.INFINITE_CACHE?void 0:H.renderOpts.collectedExpire;return{value:{kind:b.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:o}}}}catch(t){throw(null==o?void 0:o.isStale)&&await S.onRequestError(e,t,{routerKind:"App Router",routePath:n,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:j,isOnDemandRevalidate:C})},!1,T),t}},c=await S.handleResponse({req:e,nextConfig:Z,cacheKey:O,routeKind:o.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:q,isRoutePPREnabled:!1,isOnDemandRevalidate:C,revalidateOnlyGenerated:P,responseGenerator:l,waitUntil:r.waitUntil,isMinimalMode:d});if(!I)return null;if((null==c||null==(i=c.value)?void 0:i.kind)!==b.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(u=c.value)?void 0:u.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});d||t.setHeader("x-nextjs-cache",C?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),E&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,g.fromNodeOutgoingHttpHeaders)(c.value.headers);return d&&I||p.delete(x.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,f.getCacheControlHeader)(c.cacheControl)),await (0,m.sendResponse)($,K,new Response(c.value.body,{headers:p,status:c.value.status||200})),null};V?await u(V):await z.withPropagatedContext(e.headers,()=>z.trace(p.BaseServerSpan.handleRequest,{spanName:`${M} ${n}`,kind:i.SpanKind.SERVER,attributes:{"http.method":M,"http.target":e.url}},u))}catch(t){if(t instanceof y.NoFallbackError||await S.onRequestError(e,t,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:j,isOnDemandRevalidate:C})},!1,T),I)throw t;return await (0,m.sendResponse)($,K,new Response(null,{status:500})),null}}e.s(["handler",()=>_,"patchFetch",()=>I,"routeModule",()=>S,"serverHooks",()=>D,"workAsyncStorage",()=>A,"workUnitAsyncStorage",()=>k],45655)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__74b03b85._.js.map